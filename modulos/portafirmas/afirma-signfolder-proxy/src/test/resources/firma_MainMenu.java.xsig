<?xml version="1.0" encoding="UTF-8"?>
<ds:Signature Id="Signature-e377add8-4477-425f-8ac9-82494bf1ad80-Signature" xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><ds:SignedInfo><ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/><ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/><ds:Reference Id="Reference-98f2a189-8075-4b8c-94c6-791f9f8d012d" Type="http://www.w3.org/2000/09/xmldsig#Object" URI="#Object-0ef4a91b-d45b-4810-839f-8d3ca9fb4aab"><ds:Transforms><ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#base64"/></ds:Transforms><ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><ds:DigestValue>xKLetViihQqxzejDZHs19KqGPnVTcBJd6sbVyF5/SzLsvnEiA5oUp1bpCikjnonXjR8VGzf/gI3N
qCgHMN2bGg==</ds:DigestValue></ds:Reference><ds:Reference Type="http://uri.etsi.org/01903#SignedProperties" URI="#Signature-e377add8-4477-425f-8ac9-82494bf1ad80-SignedProperties"><ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><ds:DigestValue>GsHDnxSGP2wXjP+ksL6UJ5DS8SqQe08FxvVrwGhm3KwWsZMvu6yGE7x9C4V6Oavzft2MYqsm58Nb
yuP5258SKQ==</ds:DigestValue></ds:Reference><ds:Reference URI="#Signature-e377add8-4477-425f-8ac9-82494bf1ad80-KeyInfo"><ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><ds:DigestValue>iOT79waSaZFSEHb16a5CUx0QyrHS8Sgewb3Z0u+kwoU5EY4k7UyB4RNHFeiSt/epX2EpDZKv3JQY
sgzyHCtdgA==</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue Id="Signature-e377add8-4477-425f-8ac9-82494bf1ad80-SignatureValue">NztOMmpDEslS+yfdhaRveajDMWIK955OaXAWJyAbFIE1K26KyCb916Jevo5bg/PLBeJQY+8/Bpm3
cs0uvLD5DNvAKCBDdBZ5F+rqiNKHPXowG9geeTe+FrZKPXuiwTfHZo/4EI7F/hLsF4tQtz1ERrV8
R3jGHWveq6Jq5KF0xzTtdi7QaAV/egyaDmLEhIiHAchpeTAeE8L/3aHaxb0f3/UJoz7evOy0SLgo
ZApfjnCn+uRuueoZcujMmMVeK7b3Fko5LceIgqnfBlOHXcqStwVPd1xjPe7FsssAkvTvBc9O+1bd
X5cU/Xu0YsZ5gIkdWWHkdbxw9UhuQ+iyavYjBw==</ds:SignatureValue><ds:KeyInfo Id="Signature-e377add8-4477-425f-8ac9-82494bf1ad80-KeyInfo"><ds:X509Data><ds:X509Certificate>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
y+LYFVaN/zRB3xDudPqiBkZp8g==</ds:X509Certificate></ds:X509Data><ds:KeyValue><ds:RSAKeyValue><ds:Modulus>medADchs0RgWpbZj2mRio2dm7o+81y5M3dUJYH5y6RO0GlaWCCqDXAngx6wPh/39pi70lUGlqUZE
ulvocEsqJJb/09vR//F1IIpuz6LmEK/rMQhx7Jp5aatvXwY2hzuDGJ5z2Qole3VEg52q7C3pzGW9
PbCO6NF6p48JKxanez0B1j07DWB9ibFpIZIlwHAqqRi8dT0RKl+ulCqqVtSqmk4RhxpKmJ6JS6Tb
CSOnwF/AXnFKxZ6UB9/mEqorzlJkR7zAZgfqsCTNTeRQTWO/oasksHID00vL0ZINNQDXgBpcF1Nu
nNZ7xZSwNnv5byYtrEjCU4lD0bk359VMUWKf+w==</ds:Modulus><ds:Exponent>AQAB</ds:Exponent></ds:RSAKeyValue></ds:KeyValue></ds:KeyInfo><ds:Object Encoding="http://www.w3.org/2000/09/xmldsig#base64" Id="Object-0ef4a91b-d45b-4810-839f-8d3ca9fb4aab" MimeType="text/plain">LyogQ29weXJpZ2h0IChDKSAyMDExIFtHb2JpZXJubyBkZSBFc3BhbmFdDQogKiBUaGlzIGZpbGUgaXMgcGFydCBvZiAiQ2xpZW50ZSBARmlybWEiLg0KICogIkNsaWVudGUgQEZpcm1hIiBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZjoNCiAqICAgLSB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247DQogKiAgICAgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCiAqICAgLSBvciBUaGUgRXVyb3BlYW4gU29mdHdhcmUgTGljZW5zZTsgZWl0aGVyIHZlcnNpb24gMS4xIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQogKiBEYXRlOiAxMS8wMS8xMQ0KICogWW91IG1heSBjb250YWN0IHRoZSBjb3B5cmlnaHQgaG9sZGVyIGF0OiBzb3BvcnRlLmFmaXJtYTVAbXB0LmVzDQogKi8NCg0KcGFja2FnZSBlcy5nb2IuYWZpcm1hLnN0YW5kYWxvbmUudWk7DQoNCmltcG9ydCBqYXZhLmF3dC5Db21wb25lbnQ7DQppbXBvcnQgamF2YS5hd3QuVG9vbGtpdDsNCmltcG9ydCBqYXZhLmF3dC5ldmVudC5BY3Rpb25FdmVudDsNCmltcG9ydCBqYXZhLmF3dC5ldmVudC5BY3Rpb25MaXN0ZW5lcjsNCmltcG9ydCBqYXZhLmF3dC5ldmVudC5LZXlFdmVudDsNCmltcG9ydCBqYXZhLmlvLkZpbGU7DQoNCmltcG9ydCBqYXZheC5zd2luZy5Cb3g7DQppbXBvcnQgamF2YXguc3dpbmcuSkRpYWxvZzsNCmltcG9ydCBqYXZheC5zd2luZy5KRnJhbWU7DQppbXBvcnQgamF2YXguc3dpbmcuSk1lbnU7DQppbXBvcnQgamF2YXguc3dpbmcuSk1lbnVCYXI7DQppbXBvcnQgamF2YXguc3dpbmcuSk1lbnVJdGVtOw0KaW1wb3J0IGphdmF4LnN3aW5nLkpPcHRpb25QYW5lOw0KaW1wb3J0IGphdmF4LnN3aW5nLktleVN0cm9rZTsNCmltcG9ydCBqYXZheC5zd2luZy5XaW5kb3dDb25zdGFudHM7DQoNCmltcG9ydCBjb20uYXBwbGUuZWF3dC5BYm91dEhhbmRsZXI7DQppbXBvcnQgY29tLmFwcGxlLmVhd3QuQXBwRXZlbnQuQWJvdXRFdmVudDsNCmltcG9ydCBjb20uYXBwbGUuZWF3dC5BcHBFdmVudC5QcmVmZXJlbmNlc0V2ZW50Ow0KaW1wb3J0IGNvbS5hcHBsZS5lYXd0LkFwcEV2ZW50LlF1aXRFdmVudDsNCmltcG9ydCBjb20uYXBwbGUuZWF3dC5BcHBsaWNhdGlvbjsNCmltcG9ydCBjb20uYXBwbGUuZWF3dC5QcmVmZXJlbmNlc0hhbmRsZXI7DQppbXBvcnQgY29tLmFwcGxlLmVhd3QuUXVpdEhhbmRsZXI7DQppbXBvcnQgY29tLmFwcGxlLmVhd3QuUXVpdFJlc3BvbnNlOw0KDQppbXBvcnQgZXMuZ29iLmFmaXJtYS5jb3JlLkFPQ2FuY2VsbGVkT3BlcmF0aW9uRXhjZXB0aW9uOw0KaW1wb3J0IGVzLmdvYi5hZmlybWEuY29yZS5taXNjLlBsYXRmb3JtOw0KaW1wb3J0IGVzLmdvYi5hZmlybWEuY29yZS51aS5BT1VJRmFjdG9yeTsNCmltcG9ydCBlcy5nb2IuYWZpcm1hLnN0YW5kYWxvbmUuU2ltcGxlQWZpcm1hOw0KaW1wb3J0IGVzLmdvYi5hZmlybWEuc3RhbmRhbG9uZS5TaW1wbGVBZmlybWFNZXNzYWdlczsNCmltcG9ydCBlcy5nb2IuYWZpcm1hLnN0YW5kYWxvbmUudWkuaGFzaC5DaGVja0hhc2hEaWFsb2c7DQppbXBvcnQgZXMuZ29iLmFmaXJtYS5zdGFuZGFsb25lLnVpLmhhc2guQ3JlYXRlSGFzaERpYWxvZzsNCg0KLyoqIEJhcnJhIGRlIG1lbiZ1YWN1dGU7IHBhcmEgdG9kYSBsYSBhcGxpY2FjaSZvYWN1dGU7bi4NCiAqIEBhdXRob3IgVG9tJmFhY3V0ZTtzIEdhcmMmaWFjdXRlO2EtTWVyJmFhY3V0ZTtzICovDQpwdWJsaWMgZmluYWwgY2xhc3MgTWFpbk1lbnUgZXh0ZW5kcyBKTWVudUJhciB7DQoNCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25VSUQgPSAtODM2MTgwODM1MzU1NDAzNjAxNUw7DQoNCiAgICBwcml2YXRlIGZpbmFsIEpNZW51SXRlbSBmaXJtYXJNZW51SXRlbSA9IG5ldyBKTWVudUl0ZW0oKTsNCiAgICBwcml2YXRlIGZpbmFsIEpNZW51SXRlbSBhYnJpck1lbnVJdGVtID0gbmV3IEpNZW51SXRlbSgpOw0KDQogICAgcHJpdmF0ZSBmaW5hbCBKRnJhbWUgcGFyZW50Ow0KICAgIEpGcmFtZSBnZXRQYXJlbnRDb21wb25lbnQoKSB7DQogICAgCXJldHVybiB0aGlzLnBhcmVudDsNCiAgICB9DQoNCiAgICBwcml2YXRlIGZpbmFsIFNpbXBsZUFmaXJtYSBzYWY7DQogICAgU2ltcGxlQWZpcm1hIGdldFNpbXBsZUFmaXJtYSgpIHsNCiAgICAJcmV0dXJuIHRoaXMuc2FmOw0KICAgIH0NCg0KICAgIC8qKiBDb25zdHJ1eWUgbGEgYmFycmEgZGUgbWVuJnVhY3V0ZTsgZGUgbGEgYXBsaWNhY2kmb2FjdXRlO24uDQogICAgICogRW4gTVMtV2luZG93cyB5IExpbnV4IHNlIGNyZWFuIGxvcyBzaWd1aWVudGVzIGF0YWpvcyBkZSB0ZWNsYWRvOg0KICAgICAqIDx1bD4NCiAgICAgKiAgPGxpPkFsdCtBID0gTWVudSBhcmNoaXZvPC9saT4NCiAgICAgKiAgPGxpPg0KICAgICAqICAgPHVsPg0KICAgICAqICAgIDxsaT5BbHQrQiA9IEFicmlyIGFyY2hpdm88L2xpPg0KICAgICAqICAgIDxsaT5BbHQrSSA9IEZpcm1hciBhcmNoaXZvPC9saT4NCiAgICAgKiAgICA8bGk+QWx0K0ggPSBIdWVsbGFzIGRpZ2l0YWxlczwvbGk+DQogICAgICogICAgPGxpPg0KICAgICAqICAgICA8dWw+DQogICAgICogICAgICA8bGk+QWx0K0wgPSBDYWxjdWxhciBodWVsbGEgZGlnaXRhbDwvbGk+DQogICAgICogICAgICA8bGk+QWx0K1IgPSBDb21wcm9iYXIgaHVlbGxhIGRpZ2l0YWw8L2xpPg0KICAgICAqICAgICA8L3VsPg0KICAgICAqICAgIDwvbGk+DQogICAgICogICAgPGxpPkFsdCtGNCA9IFNhbGlyIGRlbCBwcm9ncmFtYTwvbGk+DQogICAgICogICA8L3VsPg0KICAgICAqICA8L2xpPg0KICAgICAqICA8bGk+QWx0K1kgPSBNZW51IEF5dWRhPC9saT4NCiAgICAgKiAgPGxpPg0KICAgICAqICAgPHVsPg0KICAgICAqICAgIDxsaT5BbHQrVSA9IEF5dWRhPC9saT4NCiAgICAgKiAgICA8bGk+QWx0K1IgPSBBY2VyY2EgZGUuLi48L2xpPg0KICAgICAqICAgPC91bD4NCiAgICAgKiAgPC9saT4NCiAgICAgKiAgPGxpPkFsdCtTID0gU2VsZWNjaW9uYXIgZmljaGVybzwvbGk+DQogICAgICogIDxsaT5BbHQrRiA9IEZpcm1hciBmaWNoZXJvPC9saT4NCiAgICAgKiAgPGxpPkN0cmwrQSA9IFNlbGVjY2lvbmFyIGZpY2hlcm88L2xpPg0KICAgICAqICA8bGk+Q3RybCtGID0gRmlybWFyIGZpY2hlcm88L2xpPg0KICAgICAqICA8bGk+QWx0K0Y0ID0gU2FsaXIgZGVsIHByb2dyYW1hPC9saT4NCiAgICAgKiAgPGxpPkYxID0gQXl1ZGE8L2xpPg0KICAgICAqICA8bGk+Q3RybCtSID0gQWNlcmNhIGRlLi4uPC9saT4NCiAgICAgKiAgPGxpPkN0cmwrSCA9IENhbGN1bGFyIGh1ZWxsYSBkaWdpdGFsPC9saT4NCiAgICAgKiAgPGxpPkN0cmwrVSA9IENvbXByb2JhciBodWVsbGEgZGlnaXRhbDwvbGk+DQogICAgICogPC91bD4NCiAgICAgKiBAcGFyYW0gcCBDb21wb25lbnRlIHBhZHJlIHBhcmEgbGEgbW9kYWxpZGFkDQogICAgICogQHBhcmFtIHMgQXBsaWNhY2kmb2FjdXRlO24gcGFkcmUsIHBhcmEgZGV0ZXJtaW5hciBlbCBuJnVhY3V0ZTttZXJvIGRlDQogICAgICogICAgICAgIGxvY2FsZXMgZSBpbnZvY2FyIGEgY2llcnRvcyBjb21hbmRvcyBkZSBtZW4mdWFjdXRlOyAqLw0KICAgIHB1YmxpYyBNYWluTWVudShmaW5hbCBKRnJhbWUgcCwgZmluYWwgU2ltcGxlQWZpcm1hIHMpIHsNCiAgICAgICAgdGhpcy5zYWYgPSBzOw0KICAgICAgICB0aGlzLnBhcmVudCA9IHA7DQogICAgICAgIC8vIEltcG9ydGFudGU6IE5vIGNhcmdhciBlbiB1biBpbnZva2VMYXRlciwgZGEgZ3VlcnJhIGVuIE1hYyBPUyBYDQogICAgICAgIGNyZWF0ZVVJKCk7DQogICAgfQ0KDQogICAgcHJpdmF0ZSB2b2lkIGNyZWF0ZVVJKCkgew0KDQogICAgICAgIGZpbmFsIGJvb2xlYW4gaXNNYWMgPSBQbGF0Zm9ybS5PUy5NQUNPU1guZXF1YWxzKFBsYXRmb3JtLmdldE9TKCkpOw0KDQogICAgICAgIGZpbmFsIEpNZW51IG1lbnVBcmNoaXZvID0gbmV3IEpNZW51KCk7DQogICAgICAgIG1lbnVBcmNoaXZvLnNldFRleHQoU2ltcGxlQWZpcm1hTWVzc2FnZXMuZ2V0U3RyaW5nKCJNYWluTWVudS4wIikpOyAvLyROT04tTkxTLTEkDQogICAgICAgIG1lbnVBcmNoaXZvLnNldE1uZW1vbmljKEtleUV2ZW50LlZLX0EpOw0KICAgICAgICBtZW51QXJjaGl2by5nZXRBY2Nlc3NpYmxlQ29udGV4dCgpLnNldEFjY2Vzc2libGVEZXNjcmlwdGlvbigNCiAgICAJCVNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuMSIpIC8vJE5PTi1OTFMtMSQNCiAgICAgICAgKTsNCiAgICAgICAgbWVudUFyY2hpdm8uc2V0RW5hYmxlZCh0cnVlKTsNCg0KICAgICAgICB0aGlzLmFicmlyTWVudUl0ZW0uc2V0VGV4dChTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjIiKSk7IC8vJE5PTi1OTFMtMSQNCiAgICAgICAgdGhpcy5hYnJpck1lbnVJdGVtLnNldEFjY2VsZXJhdG9yKEtleVN0cm9rZS5nZXRLZXlTdHJva2UoS2V5RXZlbnQuVktfQSwgVG9vbGtpdC5nZXREZWZhdWx0VG9vbGtpdCgpLmdldE1lbnVTaG9ydGN1dEtleU1hc2soKSkpOw0KICAgICAgICB0aGlzLmFicmlyTWVudUl0ZW0uZ2V0QWNjZXNzaWJsZUNvbnRleHQoKS5zZXRBY2Nlc3NpYmxlRGVzY3JpcHRpb24oDQogICAgCQlTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjMiKSAvLyROT04tTkxTLTEkDQoJCSk7DQogICAgICAgIHRoaXMuYWJyaXJNZW51SXRlbS5hZGRBY3Rpb25MaXN0ZW5lcigNCiAgICAJCW5ldyBBY3Rpb25MaXN0ZW5lcigpIHsNCgkgICAgICAgIAkvKioge0Bpbmhlcml0RG9jfSAqLw0KCSAgICAgICAgICAgIEBPdmVycmlkZQ0KCSAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFjdGlvblBlcmZvcm1lZChmaW5hbCBBY3Rpb25FdmVudCBhZSkgew0KCSAgICAgICAgICAgIAlmaW5hbCBGaWxlIGZpbGVUb0xvYWQ7DQoJICAgICAgICAgICAgCXRyeSB7DQoJICAgICAgICAgICAgCQlmaWxlVG9Mb2FkID0gQU9VSUZhY3RvcnkuZ2V0TG9hZEZpbGVzKA0KCSAgICAgICAgICAgIAkJCVNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuNCIpLCAvLyROT04tTkxTLTEkDQoJICAgICAgICAgICAgCQkJTWFpbk1lbnUudGhpcy5nZXRTaW1wbGVBZmlybWEoKS5nZXRDdXJyZW50RGlyKCkgIT0gbnVsbCA/IE1haW5NZW51LnRoaXMuZ2V0U2ltcGxlQWZpcm1hKCkuZ2V0Q3VycmVudERpcigpLmdldEFic29sdXRlUGF0aCgpIDogbnVsbCwNCgkgICAgICAgICAgICAJCQludWxsLA0KCSAgICAgICAgICAgIAkJCW51bGwsDQoJICAgICAgICAgICAgCQkJbnVsbCwNCgkgICAgICAgICAgICAJCQlmYWxzZSwNCgkgICAgICAgICAgICAJCQlmYWxzZSwNCgkgICAgICAgICAgICAJCQludWxsLA0KCSAgICAgICAgICAgIAkJCU1haW5NZW51LnRoaXMNCgkgICAgICAgIAkJCSlbMF07DQoJICAgICAgICAgICAgCX0NCgkgICAgICAgICAgICAJY2F0Y2goZmluYWwgQU9DYW5jZWxsZWRPcGVyYXRpb25FeGNlcHRpb24gZSkgew0KCSAgICAgICAgICAgIAkJcmV0dXJuOw0KCSAgICAgICAgICAgIAl9DQoJICAgICAgICAgICAgCU1haW5NZW51LnRoaXMuZ2V0U2ltcGxlQWZpcm1hKCkubG9hZEZpbGVUb1NpZ24oZmlsZVRvTG9hZCk7DQoJICAgICAgICAgICAgfQ0KCSAgICAgICAgfQ0KCQkpOw0KICAgICAgICBtZW51QXJjaGl2by5hZGQodGhpcy5hYnJpck1lbnVJdGVtKTsNCg0KICAgICAgICB0aGlzLmZpcm1hck1lbnVJdGVtLnNldFRleHQoU2ltcGxlQWZpcm1hTWVzc2FnZXMuZ2V0U3RyaW5nKCJNYWluTWVudS41IikpOyAvLyROT04tTkxTLTEkDQogICAgICAgIHRoaXMuZmlybWFyTWVudUl0ZW0uc2V0QWNjZWxlcmF0b3IoDQogICAgCQlLZXlTdHJva2UuZ2V0S2V5U3Ryb2tlKEtleUV2ZW50LlZLX0YsIFRvb2xraXQuZ2V0RGVmYXVsdFRvb2xraXQoKS5nZXRNZW51U2hvcnRjdXRLZXlNYXNrKCkpDQoJCSk7DQogICAgICAgIHRoaXMuZmlybWFyTWVudUl0ZW0uZ2V0QWNjZXNzaWJsZUNvbnRleHQoKS5zZXRBY2Nlc3NpYmxlRGVzY3JpcHRpb24oDQogICAgCQlTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjYiKSAvLyROT04tTkxTLTEkDQogICAgICAgICk7DQogICAgICAgIHRoaXMuZmlybWFyTWVudUl0ZW0uc2V0RW5hYmxlZChmYWxzZSk7DQogICAgICAgIHRoaXMuZmlybWFyTWVudUl0ZW0uYWRkQWN0aW9uTGlzdGVuZXIoDQogICAgCQluZXcgQWN0aW9uTGlzdGVuZXIoKSB7DQoJICAgICAgICAJLyoqIHtAaW5oZXJpdERvY30gKi8NCgkgICAgICAgICAgICBAT3ZlcnJpZGUNCgkgICAgICAgICAgICBwdWJsaWMgdm9pZCBhY3Rpb25QZXJmb3JtZWQoZmluYWwgQWN0aW9uRXZlbnQgZSkgew0KCSAgICAgICAgICAgICAgICBNYWluTWVudS50aGlzLmdldFNpbXBsZUFmaXJtYSgpLnNpZ25Mb2FkZWRGaWxlKCk7DQoJICAgICAgICAgICAgfQ0KCSAgICAgICAgfQ0KCQkpOw0KICAgICAgICBtZW51QXJjaGl2by5hZGQodGhpcy5maXJtYXJNZW51SXRlbSk7DQoNCiAgICAgICAgZmluYWwgSk1lbnUgaHVlbGxhTWVudSA9IG5ldyBKTWVudSgNCiAgICAJCVNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuMjUiKSAvLyROT04tTkxTLTEkDQoJCSk7DQogICAgICAgIGh1ZWxsYU1lbnUuc2V0TW5lbW9uaWMoJ0gnKTsNCiAgICAgICAgZmluYWwgSk1lbnVJdGVtIGNyZWF0ZUh1ZWxsYU1lbnVJdGVtID0gbmV3IEpNZW51SXRlbSgNCiAgICAJCVNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuMjYiKSAvLyROT04tTkxTLTEkDQoJCSk7DQogICAgICAgIGNyZWF0ZUh1ZWxsYU1lbnVJdGVtLnNldEFjY2VsZXJhdG9yKA0KICAgIAkJS2V5U3Ryb2tlLmdldEtleVN0cm9rZShLZXlFdmVudC5WS19ILCBUb29sa2l0LmdldERlZmF1bHRUb29sa2l0KCkuZ2V0TWVudVNob3J0Y3V0S2V5TWFzaygpKQ0KCQkpOw0KICAgICAgICBjcmVhdGVIdWVsbGFNZW51SXRlbS5zZXRNbmVtb25pYygnbCcpOw0KICAgICAgICBjcmVhdGVIdWVsbGFNZW51SXRlbS5hZGRBY3Rpb25MaXN0ZW5lcigNCiAgICAJCW5ldyBBY3Rpb25MaXN0ZW5lcigpIHsNCgkJCQlAT3ZlcnJpZGUNCgkJCQlwdWJsaWMgdm9pZCBhY3Rpb25QZXJmb3JtZWQoZmluYWwgQWN0aW9uRXZlbnQgZSkgew0KCQkJCQlDcmVhdGVIYXNoRGlhbG9nLnN0YXJ0SGFzaENyZWF0aW9uKGdldFBhcmVudENvbXBvbmVudCgpKTsNCgkJCQl9DQoJCQl9DQoJCSk7DQogICAgICAgIGh1ZWxsYU1lbnUuYWRkKGNyZWF0ZUh1ZWxsYU1lbnVJdGVtKTsNCg0KICAgICAgICBmaW5hbCBKTWVudUl0ZW0gY2hlY2tIdWVsbGFNZW51SXRlbSA9IG5ldyBKTWVudUl0ZW0oDQogICAgCQlTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjI3IikgLy8kTk9OLU5MUy0xJA0KCQkpOw0KICAgICAgICBjaGVja0h1ZWxsYU1lbnVJdGVtLnNldE1uZW1vbmljKCdyJyk7DQogICAgICAgIGNoZWNrSHVlbGxhTWVudUl0ZW0uc2V0QWNjZWxlcmF0b3IoDQogICAgCQlLZXlTdHJva2UuZ2V0S2V5U3Ryb2tlKEtleUV2ZW50LlZLX1UsIFRvb2xraXQuZ2V0RGVmYXVsdFRvb2xraXQoKS5nZXRNZW51U2hvcnRjdXRLZXlNYXNrKCkpDQoJCSk7DQogICAgICAgIGNoZWNrSHVlbGxhTWVudUl0ZW0uYWRkQWN0aW9uTGlzdGVuZXIoDQogICAgCQluZXcgQWN0aW9uTGlzdGVuZXIoKSB7DQoJCQkJQE92ZXJyaWRlDQoJCQkJcHVibGljIHZvaWQgYWN0aW9uUGVyZm9ybWVkKGZpbmFsIEFjdGlvbkV2ZW50IGUpIHsNCgkJCQkJQ2hlY2tIYXNoRGlhbG9nLnN0YXJ0SGFzaENoZWNrKGdldFBhcmVudENvbXBvbmVudCgpKTsNCgkJCQl9DQoJCQl9DQoJCSk7DQoNCiAgICAgICAgaHVlbGxhTWVudS5hZGQoY2hlY2tIdWVsbGFNZW51SXRlbSk7DQoNCiAgICAgICAgLy9tZW51QXJjaGl2by5hZGQoaHVlbGxhTWVudSk7DQoNCiAgICAgICAgLy8gRW4gTWFjIE9TIFggZWwgc2FsaXIgbG8gZ2VzdGlvbmEgZWwgcHJvcGlvIE9TDQogICAgICAgIGlmICghaXNNYWMpIHsNCiAgICAgICAgICAgIG1lbnVBcmNoaXZvLmFkZFNlcGFyYXRvcigpOw0KICAgICAgICAgICAgZmluYWwgSk1lbnVJdGVtIHNhbGlyTWVudUl0ZW0gPSBuZXcgSk1lbnVJdGVtKFNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuNyIpKTsgLy8kTk9OLU5MUy0xJA0KICAgICAgICAgICAgc2FsaXJNZW51SXRlbS5zZXRBY2NlbGVyYXRvcihLZXlTdHJva2UuZ2V0S2V5U3Ryb2tlKEtleUV2ZW50LlZLX0Y0LCBBY3Rpb25FdmVudC5BTFRfTUFTSykpOw0KICAgICAgICAgICAgc2FsaXJNZW51SXRlbS5nZXRBY2Nlc3NpYmxlQ29udGV4dCgpLnNldEFjY2Vzc2libGVEZXNjcmlwdGlvbigNCiAgICAgICAgCQlTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjgiKSAvLyROT04tTkxTLTEkDQogICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIHNhbGlyTWVudUl0ZW0uYWRkQWN0aW9uTGlzdGVuZXIoDQogICAgICAgIAkJbmV3IEFjdGlvbkxpc3RlbmVyKCkgew0KCSAgICAgICAgICAgIAkvKioge0Bpbmhlcml0RG9jfSAqLw0KCSAgICAgICAgICAgICAgICBAT3ZlcnJpZGUNCgkgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgYWN0aW9uUGVyZm9ybWVkKGZpbmFsIEFjdGlvbkV2ZW50IGFlKSB7DQoJICAgICAgICAgICAgICAgICAgICBleGl0QXBwbGljYXRpb24oKTsNCgkgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgIH0NCiAgICAJCSk7DQogICAgICAgICAgICBzYWxpck1lbnVJdGVtLnNldE1uZW1vbmljKEtleUV2ZW50LlZLX0wpOw0KICAgICAgICAgICAgbWVudUFyY2hpdm8uYWRkKHNhbGlyTWVudUl0ZW0pOw0KICAgICAgICB9DQoNCiAgICAgICAgdGhpcy5hZGQobWVudUFyY2hpdm8pOw0KDQogICAgICAgIC8vdGhpcy5hZGQobmV3IE1lbnVWYWxpZGF0aW9uKHRoaXMucGFyZW50KSk7DQoNCiAgICAgICAgaWYgKCFpc01hYykgew0KICAgICAgICAgICAgZmluYWwgSk1lbnUgb3B0aW9uc01lbnUgPSBuZXcgSk1lbnUoU2ltcGxlQWZpcm1hTWVzc2FnZXMuZ2V0U3RyaW5nKCJNYWluTWVudS4xOCIpKTsgLy8kTk9OLU5MUy0xJA0KICAgICAgICAgICAgb3B0aW9uc01lbnUuc2V0TW5lbW9uaWMoS2V5RXZlbnQuVktfTyk7DQogICAgICAgICAgICBvcHRpb25zTWVudS5nZXRBY2Nlc3NpYmxlQ29udGV4dCgpLnNldEFjY2Vzc2libGVEZXNjcmlwdGlvbigNCiAgICAgICAgCQlTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjE5IikgLy8kTk9OLU5MUy0xJA0KICAgICAgICAgICAgKTsNCg0KICAgICAgICAgICAgZmluYWwgSk1lbnVJdGVtIHByZWZlcmVuY2VzTWVudUl0ZW0gPSBuZXcgSk1lbnVJdGVtKFNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuMTIiKSk7IC8vJE5PTi1OTFMtMSQNCiAgICAgICAgICAgIHByZWZlcmVuY2VzTWVudUl0ZW0uc2V0QWNjZWxlcmF0b3IoDQogICAgICAgIAkJS2V5U3Ryb2tlLmdldEtleVN0cm9rZShLZXlFdmVudC5WS19QLCBUb29sa2l0LmdldERlZmF1bHRUb29sa2l0KCkuZ2V0TWVudVNob3J0Y3V0S2V5TWFzaygpKQ0KICAgIAkJKTsNCiAgICAgICAgICAgIHByZWZlcmVuY2VzTWVudUl0ZW0uc2V0TW5lbW9uaWMoS2V5RXZlbnQuVktfUCk7DQogICAgICAgICAgICBwcmVmZXJlbmNlc01lbnVJdGVtLmdldEFjY2Vzc2libGVDb250ZXh0KCkuc2V0QWNjZXNzaWJsZURlc2NyaXB0aW9uKA0KICAgICAgICAJCVNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuMTYiKSAvLyROT04tTkxTLTEkDQogICAgCQkpOw0KICAgICAgICAgICAgcHJlZmVyZW5jZXNNZW51SXRlbS5hZGRBY3Rpb25MaXN0ZW5lcigNCiAgICAgICAgCQluZXcgQWN0aW9uTGlzdGVuZXIoKSB7DQoJICAgICAgICAgICAgCS8qKiB7QGluaGVyaXREb2N9ICovDQoJCQkJCUBPdmVycmlkZQ0KCQkJCQlwdWJsaWMgdm9pZCBhY3Rpb25QZXJmb3JtZWQoZmluYWwgQWN0aW9uRXZlbnQgYWUpIHsNCgkJCQkJICAgIHNob3dQcmVmZXJlbmNlcygpOw0KCQkJCQl9DQoJCQkJfQ0KICAgIAkJKTsNCiAgICAgICAgICAgIG9wdGlvbnNNZW51LmFkZChwcmVmZXJlbmNlc01lbnVJdGVtKTsNCg0KICAgICAgICAgICAgdGhpcy5hZGQob3B0aW9uc01lbnUpOw0KICAgICAgICB9DQogICAgICAgIC8vIEVuIE1hYyBPUyBYIGVsIG1lbnUgZXMgIlByZWZlcmVuY2lhcyIgZGVudHJvIGRlIGxhIG9wY2lvbiBwcmluY2lwYWwNCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICBBcHBsaWNhdGlvbi5nZXRBcHBsaWNhdGlvbigpLnNldFByZWZlcmVuY2VzSGFuZGxlcigNCiAgICAgICAgCQluZXcgUHJlZmVyZW5jZXNIYW5kbGVyKCkgew0KCSAgICAgICAgICAgIAkvKioge0Bpbmhlcml0RG9jfSAqLw0KCSAgICAgICAgICAgICAgICBAT3ZlcnJpZGUNCgkgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgaGFuZGxlUHJlZmVyZW5jZXMoZmluYWwgUHJlZmVyZW5jZXNFdmVudCBwZSkgew0KCSAgICAgICAgICAgICAgICAgICAgc2hvd1ByZWZlcmVuY2VzKCk7DQoJICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICB9DQogICAgCQkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2VwYXJhZG9yIHBhcmEgcXVlIGxhIGF5dWRhIHF1ZWRlIGEgbGEgZGVyZWNoYSwgc2UgaWdub3JhIGVuIE1hYyBPUyBYDQogICAgICAgIHRoaXMuYWRkKEJveC5jcmVhdGVIb3Jpem9udGFsR2x1ZSgpKTsNCg0KICAgICAgICBmaW5hbCBKTWVudSBtZW51QXl1ZGEgPSBuZXcgSk1lbnUoU2ltcGxlQWZpcm1hTWVzc2FnZXMuZ2V0U3RyaW5nKCJNYWluTWVudS45IikpOyAgLy8kTk9OLU5MUy0xJA0KICAgICAgICBtZW51QXl1ZGEuc2V0TW5lbW9uaWMoS2V5RXZlbnQuVktfWSk7DQogICAgICAgIG1lbnVBeXVkYS5nZXRBY2Nlc3NpYmxlQ29udGV4dCgpLnNldEFjY2Vzc2libGVEZXNjcmlwdGlvbigNCiAgICAgICAgICBTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjEwIikgLy8kTk9OLU5MUy0xJA0KICAgICAgICApOw0KDQogICAgICAgIGZpbmFsIEpNZW51SXRlbSBheXVkYU1lbnVJdGVtID0gbmV3IEpNZW51SXRlbSgpOw0KICAgICAgICBheXVkYU1lbnVJdGVtLnNldFRleHQoU2ltcGxlQWZpcm1hTWVzc2FnZXMuZ2V0U3RyaW5nKCJNYWluTWVudS4xMSIpKTsgLy8kTk9OLU5MUy0xJA0KICAgICAgICBheXVkYU1lbnVJdGVtLnNldEFjY2VsZXJhdG9yKEtleVN0cm9rZS5nZXRLZXlTdHJva2UoIkYxIikpOyAvLyROT04tTkxTLTEkDQogICAgICAgIGF5dWRhTWVudUl0ZW0uZ2V0QWNjZXNzaWJsZUNvbnRleHQoKS5zZXRBY2Nlc3NpYmxlRGVzY3JpcHRpb24oDQogICAgICAgICAgICAgIFNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuMTMiKSAvLyROT04tTkxTLTEkDQogICAgICAgICk7DQogICAgICAgIGF5dWRhTWVudUl0ZW0uYWRkQWN0aW9uTGlzdGVuZXIoDQogICAgCQluZXcgQWN0aW9uTGlzdGVuZXIoKSB7DQoJICAgICAgICAgICAgQE92ZXJyaWRlDQoJICAgICAgICAgICAgcHVibGljIHZvaWQgYWN0aW9uUGVyZm9ybWVkKGZpbmFsIEFjdGlvbkV2ZW50IGUpIHsNCgkgICAgICAgICAgICAgICAgU2ltcGxlQWZpcm1hLnNob3dIZWxwKCk7DQoJICAgICAgICAgICAgfQ0KCSAgICAgICAgfQ0KCQkpOw0KICAgICAgICBtZW51QXl1ZGEuYWRkKGF5dWRhTWVudUl0ZW0pOw0KDQogICAgICAgIC8vIEVuIE1hYyBPUyBYIGVsIEFjZXJjYSBkZSBsbyBnZXN0aW9uYSBlbCBwcm9waW8gT1MNCiAgICAgICAgaWYgKCFpc01hYykgew0KICAgICAgICAgICAgbWVudUF5dWRhLmFkZFNlcGFyYXRvcigpOw0KICAgICAgICAgICAgZmluYWwgSk1lbnVJdGVtIGFjZXJjYU1lbnVJdGVtID0gbmV3IEpNZW51SXRlbShTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjE1IikpOyAvLyROT04tTkxTLTEkDQogICAgICAgICAgICBhY2VyY2FNZW51SXRlbS5nZXRBY2Nlc3NpYmxlQ29udGV4dCgpLnNldEFjY2Vzc2libGVEZXNjcmlwdGlvbigNCiAgICAgICAgCQlTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjE3IikgLy8kTk9OLU5MUy0xJA0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIGFjZXJjYU1lbnVJdGVtLnNldEFjY2VsZXJhdG9yKEtleVN0cm9rZS5nZXRLZXlTdHJva2UoS2V5RXZlbnQuVktfUiwgVG9vbGtpdC5nZXREZWZhdWx0VG9vbGtpdCgpLmdldE1lbnVTaG9ydGN1dEtleU1hc2soKSkpOw0KICAgICAgICAgICAgYWNlcmNhTWVudUl0ZW0uYWRkQWN0aW9uTGlzdGVuZXIobmV3IEFjdGlvbkxpc3RlbmVyKCkgew0KICAgICAgICAgICAgICAgIEBPdmVycmlkZQ0KICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFjdGlvblBlcmZvcm1lZChmaW5hbCBBY3Rpb25FdmVudCBhZSkgew0KICAgICAgICAgICAgICAgICAgICBzaG93QWJvdXQoTWFpbk1lbnUudGhpcy5nZXRQYXJlbnRDb21wb25lbnQoKSA9PSBudWxsID8gTWFpbk1lbnUudGhpcyA6IE1haW5NZW51LnRoaXMuZ2V0UGFyZW50Q29tcG9uZW50KCkpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgYWNlcmNhTWVudUl0ZW0uc2V0TW5lbW9uaWMoS2V5RXZlbnQuVktfUik7DQogICAgICAgICAgICBtZW51QXl1ZGEuYWRkKGFjZXJjYU1lbnVJdGVtKTsNCiAgICAgICAgICAgIHRoaXMuYWRkKG1lbnVBeXVkYSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBMb3MgbW5lbW9uaWNvcyBlbiBlbGVtZW50b3MgZGUgbWVudSB2aW9sYW4gbGFzIG5vcm1hcyBkZSBpbnRlcmZheiBkZSBBcHBsZSwNCiAgICAgICAgLy8gYXNpIHF1ZSBwcmVzY2luZGltb3MgZGUgZWxsb3MgZW4gTWFjIE9TIFgNCiAgICAgICAgaWYgKCFpc01hYykgew0KICAgICAgICAgICAgdGhpcy5hYnJpck1lbnVJdGVtLnNldE1uZW1vbmljKEtleUV2ZW50LlZLX0IpOw0KICAgICAgICAgICAgYXl1ZGFNZW51SXRlbS5zZXRNbmVtb25pYyhLZXlFdmVudC5WS19VKTsNCiAgICAgICAgICAgIHRoaXMuZmlybWFyTWVudUl0ZW0uc2V0TW5lbW9uaWMoS2V5RXZlbnQuVktfRik7DQogICAgICAgIH0NCiAgICAgICAgLy8gQWNjaW9uZXMgZXNwZWNpZmljYXMgZGUgTWFjIE9TIFgNCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICBBcHBsaWNhdGlvbi5nZXRBcHBsaWNhdGlvbigpLnNldEFib3V0SGFuZGxlcigNCiAgICAgICAgCQluZXcgQWJvdXRIYW5kbGVyKCkgew0KCSAgICAgICAgICAgICAgICBAT3ZlcnJpZGUNCgkgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgaGFuZGxlQWJvdXQoZmluYWwgQWJvdXRFdmVudCBhZSkgew0KCSAgICAgICAgICAgICAgICAgICAgc2hvd0Fib3V0KE1haW5NZW51LnRoaXMuZ2V0UGFyZW50Q29tcG9uZW50KCkgPT0gbnVsbCA/IE1haW5NZW51LnRoaXMgOiBNYWluTWVudS50aGlzLmdldFBhcmVudENvbXBvbmVudCgpKTsNCgkgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgIH0NCiAgICAJCSk7DQogICAgICAgICAgICBBcHBsaWNhdGlvbi5nZXRBcHBsaWNhdGlvbigpLnNldFF1aXRIYW5kbGVyKA0KICAgICAgICAJCW5ldyBRdWl0SGFuZGxlcigpIHsNCgkgICAgICAgICAgICAgICAgQE92ZXJyaWRlDQoJICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIGhhbmRsZVF1aXRSZXF1ZXN0V2l0aChmaW5hbCBRdWl0RXZlbnQgcWUsIGZpbmFsIFF1aXRSZXNwb25zZSBxcikgew0KCSAgICAgICAgICAgICAgICAgICAgaWYgKCFleGl0QXBwbGljYXRpb24oKSkgew0KCSAgICAgICAgICAgICAgICAgICAgICAgIHFyLmNhbmNlbFF1aXQoKTsNCgkgICAgICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgfQ0KICAgICAgICAJCX0NCiAgICAJCSk7DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIC8qKiBIYWJpbGl0YSBvIGRlc2hhYmlsaXRhIGVsIG1lbiZ1YWN1dGU7IGRlIG9wZXJhY2lvbmVzIHNvYnJlIGZpY2hlcm9zLg0KICAgICAqIEBwYXJhbSBlbiA8Y29kZT50cnVlPC9jb2RlPiBwYXJhIGhhYmlsaXRhciBsYXMgb3BlcmFjaW9uZXMgc29icmUgZmljaGVyb3MsIDxjb2RlPmZhbHNlPC9jb2RlPiBwYXJhIGRlc2hhYmlsaXRhcmxhcyAqLw0KICAgIHB1YmxpYyB2b2lkIHNldEVuYWJsZWRPcGVuQ29tbWFuZChmaW5hbCBib29sZWFuIGVuKSB7DQogICAgICAgIGlmICh0aGlzLmFicmlyTWVudUl0ZW0gIT0gbnVsbCkgew0KICAgICAgICAgICAgdGhpcy5hYnJpck1lbnVJdGVtLnNldEVuYWJsZWQoZW4pOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqIEhhYmlsaXRhIG8gZGVzaGFiaWxpdGEgZWwgZWxlbWVudG8gZGUgbWVuJnVhY3V0ZTsgZGUgZmlybWEgZGUgZmljaGVyby4NCiAgICAgKiBAcGFyYW0gZW4gPGNvZGU+dHJ1ZTwvY29kZT4gcGFyYSBoYWJpbGl0YXIgZWwgZWxlbWVudG8gZGUgbWVuJnVhY3V0ZTsgZGUgZmlybWEgZGUgZmljaGVybywgPGNvZGU+ZmFsc2U8L2NvZGU+IHBhcmEgZGVzaGFiaWxpdGFybG8gKi8NCiAgICBwdWJsaWMgdm9pZCBzZXRFbmFibGVkU2lnbkNvbW1hbmQoZmluYWwgYm9vbGVhbiBlbikgew0KICAgICAgICBpZiAodGhpcy5maXJtYXJNZW51SXRlbSAhPSBudWxsKSB7DQogICAgICAgICAgICB0aGlzLmZpcm1hck1lbnVJdGVtLnNldEVuYWJsZWQoZW4pOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgdm9pZCBzaG93UHJlZmVyZW5jZXMoKSB7DQogICAgICAgIGZpbmFsIEpEaWFsb2cgcHJlZmVyZW5jZXNEaWFsb2cgPSBuZXcgSkRpYWxvZyhNYWluTWVudS50aGlzLmdldFBhcmVudENvbXBvbmVudCgpLCB0cnVlKTsNCiAgICAgICAgcHJlZmVyZW5jZXNEaWFsb2cuc2V0VGl0bGUoU2ltcGxlQWZpcm1hTWVzc2FnZXMuZ2V0U3RyaW5nKCJNYWluTWVudS4yNCIpKTsgLy8kTk9OLU5MUy0xJA0KICAgICAgICBwcmVmZXJlbmNlc0RpYWxvZy5hZGQobmV3IFByZWZlcmVuY2VzUGFuZWwocHJlZmVyZW5jZXNEaWFsb2cpKTsNCiAgICAgICAgcHJlZmVyZW5jZXNEaWFsb2cuc2V0U2l6ZSg4MDAsIDY1MCk7DQogICAgICAgIHByZWZlcmVuY2VzRGlhbG9nLnNldFJlc2l6YWJsZShmYWxzZSk7DQogICAgICAgIHByZWZlcmVuY2VzRGlhbG9nLnNldExvY2F0aW9uUmVsYXRpdmVUbyhNYWluTWVudS50aGlzLmdldFBhcmVudENvbXBvbmVudCgpKTsNCiAgICAgICAgcHJlZmVyZW5jZXNEaWFsb2cuc2V0RGVmYXVsdENsb3NlT3BlcmF0aW9uKFdpbmRvd0NvbnN0YW50cy5ESVNQT1NFX09OX0NMT1NFKTsNCiAgICAgICAgcHJlZmVyZW5jZXNEaWFsb2cuc2V0VmlzaWJsZSh0cnVlKTsNCiAgICB9DQoNCiAgICAvKiogTXVlc3RyYSBlbiBPUyBYIGVsIG1lbiZ1YWN1dGU7ICJBY2VyY2EgZGUuLi4iLg0KICAgICAqIEBwYXJhbSBwYXJlbnRDb21wb25lbnQgQ29tcG9uZW50ZSBwYWRyZSBwYXJhIGxhIG1vZGFsaWRhZC4gKi8NCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgc2hvd0Fib3V0KGZpbmFsIENvbXBvbmVudCBwYXJlbnRDb21wb25lbnQpIHsNCiAgICAgICAgQU9VSUZhY3Rvcnkuc2hvd01lc3NhZ2VEaWFsb2coDQogICAgCQlwYXJlbnRDb21wb25lbnQsDQoJCQlTaW1wbGVBZmlybWFNZXNzYWdlcy5nZXRTdHJpbmcoIk1haW5NZW51LjE0IiwgU2ltcGxlQWZpcm1hLmdldFZlcnNpb24oKSwgU3lzdGVtLmdldFByb3BlcnR5KCJqYXZhLnZlcnNpb24iKSksIC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJCwNCiAgICAgICAgICAgIFNpbXBsZUFmaXJtYU1lc3NhZ2VzLmdldFN0cmluZygiTWFpbk1lbnUuMTUiKSwgLy8kTk9OLU5MUy0xJA0KICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRQ0KICAgICAgICApOw0KICAgIH0NCg0KICAgIGJvb2xlYW4gZXhpdEFwcGxpY2F0aW9uKCkgew0KICAgICAgICByZXR1cm4gdGhpcy5zYWYuYXNrRm9yQ2xvc2luZygpOw0KICAgIH0NCg0KfQ0K</ds:Object><ds:Object><xades:QualifyingProperties Id="Signature-e377add8-4477-425f-8ac9-82494bf1ad80-QualifyingProperties" Target="#Signature-e377add8-4477-425f-8ac9-82494bf1ad80-Signature" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xades="http://uri.etsi.org/01903/v1.3.2#"><xades:SignedProperties Id="Signature-e377add8-4477-425f-8ac9-82494bf1ad80-SignedProperties"><xades:SignedSignatureProperties><xades:SigningTime>2016-01-19T14:13:50+01:00</xades:SigningTime><xades:SigningCertificate><xades:Cert><xades:CertDigest><ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><ds:DigestValue>GXHwmNw/mgj90UD7YPSxU1OPigjGlpGX3Ls+MLDMLNocSYJCMZa5X0iVIrASPxRNx4WUXF7ZLFF2IIgj0Y7xlg==</ds:DigestValue></xades:CertDigest><xades:IssuerSerial><ds:X509IssuerName>CN=AC DNIE 001, OU=DNIE, O=DIRECCION GENERAL DE LA POLICIA, C=ES</ds:X509IssuerName><ds:X509SerialNumber>99920002544982625090240895106258419311</ds:X509SerialNumber></xades:IssuerSerial></xades:Cert></xades:SigningCertificate></xades:SignedSignatureProperties><xades:SignedDataObjectProperties><xades:DataObjectFormat ObjectReference="#Reference-98f2a189-8075-4b8c-94c6-791f9f8d012d"><xades:Description/><xades:MimeType>text/plain</xades:MimeType><xades:Encoding>http://www.w3.org/2000/09/xmldsig#base64</xades:Encoding></xades:DataObjectFormat></xades:SignedDataObjectProperties></xades:SignedProperties></xades:QualifyingProperties></ds:Object></ds:Signature>